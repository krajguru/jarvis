{ "Artifacts" : { "artifact_name" : "kerberos_descriptor" }, "artifact_data" : { "services" : [ { "components" : [ { "name" : "ACCUMULO_CLIENT" }, { "name" : "ACCUMULO_GC" }, { "identities" : [ { "name" : "accumulo_accumulo_master_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" } ], "name" : "ACCUMULO_MASTER" }, { "name" : "ACCUMULO_MONITOR" }, { "name" : "ACCUMULO_TRACER" }, { "name" : "ACCUMULO_TSERVER" } ], "configurations" : [ { "accumulo-site" : { "general.delegation.token.lifetime" : "7d", "general.delegation.token.update.interval" : "1d", "instance.rpc.sasl.enabled" : "true", "instance.security.authenticator" : "org.apache.accumulo.server.security.handler.KerberosAuthenticator", "instance.security.authorizor" : "org.apache.accumulo.server.security.handler.KerberosAuthorizor", "instance.security.permissionHandler" : "org.apache.accumulo.server.security.handler.KerberosPermissionHandler", "trace.token.type" : "org.apache.accumulo.core.client.security.tokens.KerberosToken" } }, { "client" : { "kerberos.server.primary" : "{{bare_accumulo_principal}}" } } ], "identities" : [ { "keytab" : { "configuration" : "accumulo-env/accumulo_user_keytab", "file" : "${keytab_dir}/accumulo.headless.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${accumulo-env/accumulo_user}" } }, "name" : "accumulo", "principal" : { "configuration" : "accumulo-env/accumulo_principal_name", "local_username" : "${accumulo-env/accumulo_user}", "type" : "user", "value" : "${accumulo-env/accumulo_user}${principal_suffix}@${realm}" } }, { "keytab" : { "configuration" : "accumulo-site/general.kerberos.keytab", "file" : "${keytab_dir}/accumulo.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${accumulo-env/accumulo_user}" } }, "name" : "accumulo_service", "principal" : { "configuration" : "accumulo-site/general.kerberos.principal", "local_username" : "${accumulo-env/accumulo_user}", "type" : "service", "value" : "${accumulo-env/accumulo_user}/_HOST@${realm}" } }, { "name" : "accumulo_smokeuser", "reference" : "/smokeuser" }, { "keytab" : { "configuration" : "accumulo-site/trace.token.property.keytab", "file" : "${keytab_dir}/accumulo-tracer.headless.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${accumulo-env/accumulo_user}" } }, "name" : "accumulo_tracer", "principal" : { "configuration" : "accumulo-site/trace.user", "local_username" : "${accumulo-env/accumulo_user}", "type" : "user", "value" : "tracer${principal_suffix}@${realm}" } } ], "name" : "ACCUMULO" }, { "components" : [ { "identities" : [ { "keytab" : { "configuration" : "infra-solr-env/infra_solr_kerberos_keytab", "file" : "${keytab_dir}/ambari-infra-solr.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${infra-solr-env/infra_solr_user}" } }, "name" : "infra-solr", "principal" : { "configuration" : "infra-solr-env/infra_solr_kerberos_principal", "local_username" : null, "type" : "service", "value" : "infra-solr/_HOST@${realm}" } } ], "name" : "INFRA_SOLR" }, { "name" : "INFRA_SOLR_CLIENT" } ], "identities" : [ { "name" : "ambari_infra_smokeuser", "reference" : "/smokeuser" }, { "keytab" : { "configuration" : "infra-solr-env/infra_solr_web_kerberos_keytab", "file" : null }, "name" : "ambari_infra_spnego", "principal" : { "configuration" : "infra-solr-env/infra_solr_web_kerberos_principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "AMBARI_INFRA_SOLR" }, { "components" : [ { "configurations" : [ { "ams-hbase-security-site" : { "hadoop.security.authentication" : "kerberos", "hbase.coprocessor.master.classes" : "org.apache.hadoop.hbase.security.access.AccessController", "hbase.coprocessor.region.classes" : "org.apache.hadoop.hbase.security.token.TokenProvider,org.apache.hadoop.hbase.security.access.AccessController", "hbase.security.authentication" : "kerberos", "hbase.security.authorization" : "true", "hbase.zookeeper.property.authProvider.1" : "org.apache.zookeeper.server.auth.SASLAuthenticationProvider", "hbase.zookeeper.property.jaasLoginRenew" : "3600000", "hbase.zookeeper.property.kerberos.removeHostFromPrincipal" : "true", "hbase.zookeeper.property.kerberos.removeRealmFromPrincipal" : "true" } }, { "ams-hbase-site" : { "zookeeper.znode.parent" : "/ams-hbase-secure" } } ], "identities" : [ { "name" : "ambari_metrics_metrics_collector_hdfs", "reference" : "/HDFS/NAMENODE/hdfs", "when" : { "contains" : [ "services", "HDFS" ] } }, { "keytab" : { "configuration" : "ams-hbase-security-site/hbase.myclient.keytab", "file" : "${keytab_dir}/ams.collector.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${ams-env/ambari_metrics_user}" } }, "name" : "ams_collector", "principal" : { "configuration" : "ams-hbase-security-site/hbase.myclient.principal", "local_username" : "${ams-env/ambari_metrics_user}", "type" : "service", "value" : "amshbase/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ams-hbase-security-site/hbase.master.keytab.file", "file" : "${keytab_dir}/ams-hbase.master.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${ams-env/ambari_metrics_user}" } }, "name" : "ams_hbase_master_hbase", "principal" : { "configuration" : "ams-hbase-security-site/hbase.master.kerberos.principal", "local_username" : "${ams-env/ambari_metrics_user}", "type" : "service", "value" : "amshbase/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ams-hbase-security-site/hbase.regionserver.keytab.file", "file" : "${keytab_dir}/ams-hbase.regionserver.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${ams-env/ambari_metrics_user}" } }, "name" : "ams_hbase_regionserver_hbase", "principal" : { "configuration" : "ams-hbase-security-site/hbase.regionserver.kerberos.principal", "local_username" : "${ams-env/ambari_metrics_user}", "type" : "service", "value" : "amshbase/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ams-hbase-security-site/ams.zookeeper.keytab", "file" : "${keytab_dir}/ams-zk.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${ams-env/ambari_metrics_user}" } }, "name" : "ams_zookeeper", "principal" : { "configuration" : "ams-hbase-security-site/ams.zookeeper.principal", "local_username" : "${ams-env/ambari_metrics_user}", "type" : "service", "value" : "amszk/_HOST@${realm}" } } ], "name" : "METRICS_COLLECTOR" }, { "identities" : [ { "keytab" : { "configuration" : "ams-hbase-security-site/ams.monitor.keytab", "file" : "${keytab_dir}/ams-monitor.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${ams-env/ambari_metrics_user}" } }, "name" : "ams_monitor", "principal" : { "configuration" : "ams-hbase-security-site/ams.monitor.principal", "local_username" : "${ams-env/ambari_metrics_user}", "type" : "service", "value" : "amsmon/_HOST@${realm}" } } ], "name" : "METRICS_MONITOR" } ], "identities" : [ { "name" : "ambari_metrics_spnego", "reference" : "/spnego" } ], "name" : "AMBARI_METRICS" }, { "auth_to_local_properties" : [ "application-properties/atlas.authentication.method.kerberos.name.rules|new_lines_escaped" ], "components" : [ { "identities" : [ { "keytab" : { "configuration" : "application-properties/atlas.jaas.KafkaClient.option.keyTab", "file" : "${keytab_dir}/atlas.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${atlas-env/metadata_user}" } }, "name" : "atlas", "principal" : { "configuration" : "application-properties/atlas.jaas.KafkaClient.option.principal", "local_username" : "${atlas-env/metadata_user}", "type" : "service", "value" : "atlas/_HOST@${realm}" } }, { "name" : "atlas_atlas_server_infra-solr", "reference" : "/AMBARI_INFRA_SOLR/INFRA_SOLR/infra-solr" }, { "name" : "atlas_atlas_server_kafka_broker", "reference" : "/KAFKA/KAFKA_BROKER/kafka_broker" }, { "keytab" : { "configuration" : "application-properties/atlas.authentication.method.kerberos.keytab", "file" : null }, "name" : "atlas_atlas_server_spnego", "principal" : { "configuration" : "application-properties/atlas.authentication.method.kerberos.principal", "local_username" : null, "type" : null, "value" : "HTTP/_HOST@${realm}" }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "application-properties/atlas.authentication.keytab", "file" : null }, "name" : "atlas_auth", "principal" : { "configuration" : "application-properties/atlas.authentication.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/ATLAS/ATLAS_SERVER/atlas" }, { "keytab" : { "configuration" : "ranger-atlas-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "ranger_atlas_audit", "principal" : { "configuration" : "ranger-atlas-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/ATLAS/ATLAS_SERVER/atlas" } ], "name" : "ATLAS_SERVER" } ], "configurations" : [ { "application-properties" : { "atlas.authentication.method.kerberos" : "true", "atlas.jaas.KafkaClient.loginModuleControlFlag" : "required", "atlas.jaas.KafkaClient.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "atlas.jaas.KafkaClient.option.serviceName" : "${kafka-env/kafka_user}", "atlas.jaas.KafkaClient.option.storeKey" : "true", "atlas.jaas.KafkaClient.option.useKeyTab" : "true", "atlas.kafka.sasl.kerberos.service.name" : "${kafka-env/kafka_user}", "atlas.kafka.security.protocol" : "PLAINTEXTSASL", "atlas.server.ha.zookeeper.acl" : "auth:", "atlas.solr.kerberos.enable" : "true" } }, { "ranger-atlas-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "name" : "ATLAS" }, { "auth_to_local_properties" : [ "druid-common/druid.auth.authenticator.kerberos.authToLocal|new_lines_escaped" ], "components" : [ { "name" : "DRUID_BROKER" }, { "name" : "DRUID_COORDINATOR" }, { "name" : "DRUID_HISTORICAL" }, { "name" : "DRUID_MIDDLEMANAGER" }, { "name" : "DRUID_OVERLORD" }, { "name" : "DRUID_ROUTER" } ], "configurations" : [ { "druid-common" : { "druid.auth.authenticator.kerberos.cookieSignatureSecret" : "cookie-signature-secret", "druid.auth.authenticator.kerberos.type" : "kerberos", "druid.auth.authenticatorChain" : "[\"kerberos\"]", "druid.escalator.authorizerName" : "allowAll", "druid.escalator.type" : "kerberos", "druid.security.extensions.loadList" : "[\"druid-kerberos\"]" } } ], "identities" : [ { "keytab" : { "configuration" : "druid-common/druid.escalator.internalClientKeytab", "file" : "${keytab_dir}/druid.headless.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${druid-env/druid_user}" } }, "name" : "druid_escalator_client", "principal" : { "configuration" : "druid-common/druid.escalator.internalClientPrincipal", "local_username" : "${druid-env/druid_user}", "type" : "user", "value" : "${druid-env/druid_user}${principal_suffix}@${realm}" } }, { "keytab" : { "configuration" : "druid-common/druid.hadoop.security.kerberos.keytab", "file" : "${keytab_dir}/druid.headless.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${druid-env/druid_user}" } }, "name" : "druid_hdfs", "principal" : { "configuration" : "druid-common/druid.hadoop.security.kerberos.principal", "local_username" : "${druid-env/druid_user}", "type" : "user", "value" : "${druid-env/druid_user}${principal_suffix}@${realm}" } }, { "name" : "druid_smokeuser", "reference" : "/smokeuser" }, { "keytab" : { "configuration" : "druid-common/druid.auth.authenticator.kerberos.serverKeytab", "file" : null }, "name" : "druid_spnego", "principal" : { "configuration" : "druid-common/druid.auth.authenticator.kerberos.serverPrincipal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "DRUID" }, { "components" : [ { "configurations" : [ { "hbase-atlas-application-properties" : { "atlas.jaas.ticketBased-KafkaClient.loginModuleControlFlag" : "required", "atlas.jaas.ticketBased-KafkaClient.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "atlas.jaas.ticketBased-KafkaClient.option.useTicketCache" : "true" } } ], "identities" : [ { "keytab" : { "configuration" : "hbase-atlas-application-properties/atlas.jaas.KafkaClient.option.keyTab", "file" : null }, "name" : "hbase_atlas_hook_kafka", "principal" : { "configuration" : "hbase-atlas-application-properties/atlas.jaas.KafkaClient.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HBASE/HBASE_MASTER/hbase_master_hbase" }, { "name" : "hbase_hbase_master_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "hbase-site/hbase.security.authentication.spnego.kerberos.keytab", "file" : null }, "name" : "hbase_hbase_master_spnego", "principal" : { "configuration" : "hbase-site/hbase.security.authentication.spnego.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "hbase-site/hbase.master.keytab.file", "file" : "${keytab_dir}/hbase.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hbase-env/hbase_user}" } }, "name" : "hbase_master_hbase", "principal" : { "configuration" : "hbase-site/hbase.master.kerberos.principal", "local_username" : "${hbase-env/hbase_user}", "type" : "service", "value" : "hbase/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ranger-hbase-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "ranger_hbase_audit", "principal" : { "configuration" : "ranger-hbase-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HBASE/HBASE_MASTER/hbase_master_hbase" } ], "name" : "HBASE_MASTER" }, { "identities" : [ { "keytab" : { "configuration" : "hbase-site/hbase.security.authentication.spnego.kerberos.keytab", "file" : null }, "name" : "hbase_hbase_regionserver_spnego", "principal" : { "configuration" : "hbase-site/hbase.security.authentication.spnego.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "hbase-site/hbase.regionserver.keytab.file", "file" : "${keytab_dir}/hbase.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hbase-env/hbase_user}" } }, "name" : "hbase_regionserver_hbase", "principal" : { "configuration" : "hbase-site/hbase.regionserver.kerberos.principal", "local_username" : "${hbase-env/hbase_user}", "type" : "service", "value" : "hbase/_HOST@${realm}" } } ], "name" : "HBASE_REGIONSERVER" }, { "identities" : [ { "keytab" : { "configuration" : "hbase-site/phoenix.queryserver.keytab.file", "file" : null }, "name" : "phoenix_spnego", "principal" : { "configuration" : "hbase-site/phoenix.queryserver.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "PHOENIX_QUERY_SERVER" } ], "configurations" : [ { "hbase-site" : { "hbase.bulkload.staging.dir" : "/apps/hbase/staging", "hbase.coprocessor.master.classes" : "{{hbase_coprocessor_master_classes}}", "hbase.coprocessor.region.classes" : "{{hbase_coprocessor_region_classes}}", "hbase.coprocessor.regionserver.classes" : "{{hbase_coprocessor_regionserver_classes}}", "hbase.master.ui.readonly" : "true", "hbase.security.authentication" : "kerberos", "hbase.security.authorization" : "true", "zookeeper.znode.parent" : "/hbase-secure" } }, { "ranger-hbase-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "keytab" : { "configuration" : "hbase-env/hbase_user_keytab", "file" : "${keytab_dir}/hbase.headless.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hbase-env/hbase_user}" } }, "name" : "hbase", "principal" : { "configuration" : "hbase-env/hbase_principal_name", "local_username" : "${hbase-env/hbase_user}", "type" : "user", "value" : "${hbase-env/hbase_user}${principal_suffix}@${realm}" } }, { "name" : "hbase_smokeuser", "reference" : "/smokeuser" }, { "name" : "hbase_spnego", "reference" : "/spnego" } ], "name" : "HBASE" }, { "auth_to_local_properties" : [ "core-site/hadoop.security.auth_to_local" ], "components" : [ { "configurations" : [ { "hdfs-site" : { "dfs.data.transfer.protection" : "authentication,privacy", "dfs.datanode.address" : "0.0.0.0:1019", "dfs.datanode.http.address" : "0.0.0.0:1022" } } ], "identities" : [ { "keytab" : { "configuration" : "hdfs-site/dfs.datanode.keytab.file", "file" : "${keytab_dir}/dn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hadoop-env/hdfs_user}" } }, "name" : "datanode_dn", "principal" : { "configuration" : "hdfs-site/dfs.datanode.kerberos.principal", "local_username" : "${hadoop-env/hdfs_user}", "type" : "service", "value" : "dn/_HOST@${realm}" } } ], "name" : "DATANODE" }, { "identities" : [ { "name" : "hdfs_hdfs_client_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" } ], "name" : "HDFS_CLIENT" }, { "identities" : [ { "name" : "hdfs_journalnode_spnego", "principal" : { "configuration" : "hdfs-site/dfs.journalnode.kerberos.internal.spnego.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "hdfs-site/dfs.journalnode.keytab.file", "file" : "${keytab_dir}/jn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hadoop-env/hdfs_user}" } }, "name" : "journalnode_jn", "principal" : { "configuration" : "hdfs-site/dfs.journalnode.kerberos.principal", "local_username" : "${hadoop-env/hdfs_user}", "type" : "service", "value" : "jn/_HOST@${realm}" } } ], "name" : "JOURNALNODE" }, { "configurations" : [ { "hdfs-site" : { "dfs.block.access.token.enable" : "true" } } ], "identities" : [ { "keytab" : { "configuration" : "hadoop-env/hdfs_user_keytab", "file" : "${keytab_dir}/hdfs.headless.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hadoop-env/hdfs_user}" } }, "name" : "hdfs", "principal" : { "configuration" : "hadoop-env/hdfs_principal_name", "local_username" : "${hadoop-env/hdfs_user}", "type" : "user", "value" : "${hadoop-env/hdfs_user}${principal_suffix}@${realm}" } }, { "keytab" : { "configuration" : "ranger-hdfs-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "hdfs_namenode_namenode_nn", "principal" : { "configuration" : "ranger-hdfs-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HDFS/NAMENODE/namenode_nn" }, { "name" : "hdfs_namenode_spnego", "principal" : { "configuration" : "hdfs-site/dfs.namenode.kerberos.internal.spnego.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "hdfs-site/dfs.namenode.keytab.file", "file" : "${keytab_dir}/nn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hadoop-env/hdfs_user}" } }, "name" : "namenode_nn", "principal" : { "configuration" : "hdfs-site/dfs.namenode.kerberos.principal", "local_username" : "${hadoop-env/hdfs_user}", "type" : "service", "value" : "nn/_HOST@${realm}" } } ], "name" : "NAMENODE" }, { "identities" : [ { "keytab" : { "configuration" : "hdfs-site/nfs.keytab.file", "file" : "${keytab_dir}/nfs.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hadoop-env/hdfs_user}" } }, "name" : "nfsgateway", "principal" : { "configuration" : "hdfs-site/nfs.kerberos.principal", "local_username" : "${hadoop-env/hdfs_user}", "type" : "service", "value" : "nfs/_HOST@${realm}" } } ], "name" : "NFS_GATEWAY" }, { "identities" : [ { "name" : "hdfs_secondary_namenode_spnego", "principal" : { "configuration" : "hdfs-site/dfs.secondary.namenode.kerberos.internal.spnego.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "hdfs-site/dfs.secondary.namenode.keytab.file", "file" : "${keytab_dir}/nn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hadoop-env/hdfs_user}" } }, "name" : "secondary_namenode_nn", "principal" : { "configuration" : "hdfs-site/dfs.secondary.namenode.kerberos.principal", "local_username" : "${hadoop-env/hdfs_user}", "type" : "service", "value" : "nn/_HOST@${realm}" } } ], "name" : "SECONDARY_NAMENODE" } ], "configurations" : [ { "core-site" : { "ha.zookeeper.acl" : "sasl:nn:rwcda", "hadoop.http.authentication.signature.secret.file" : "/etc/security/http_secret", "hadoop.http.authentication.simple.anonymous.allowed" : "false", "hadoop.http.authentication.type" : "kerberos", "hadoop.http.filter.initializers" : "org.apache.hadoop.security.AuthenticationFilterInitializer,org.apache.hadoop.security.HttpCrossOriginFilterInitializer", "hadoop.proxyuser.HTTP.groups" : "${hadoop-env/proxyuser_group}", "hadoop.rpc.protection" : "authentication,privacy", "hadoop.security.authentication" : "kerberos", "hadoop.security.authorization" : "true" } }, { "ranger-hdfs-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "keytab" : { "configuration" : "core-site/hadoop.http.authentication.kerberos.keytab", "file" : null }, "name" : "hadoop_http_spnego", "principal" : { "configuration" : "core-site/hadoop.http.authentication.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "name" : "hdfs_smokeuser", "reference" : "/smokeuser" }, { "keytab" : { "configuration" : "hdfs-site/dfs.web.authentication.kerberos.keytab", "file" : null }, "name" : "hdfs_spnego", "principal" : { "configuration" : "hdfs-site/dfs.web.authentication.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "HDFS" }, { "components" : [ { "identities" : [ { "keytab" : { "configuration" : "hive-site/hive.metastore.kerberos.keytab.file", "file" : null }, "name" : "hive_hive_metastore_hive_server_hive", "principal" : { "configuration" : "hive-site/hive.metastore.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HIVE/HIVE_SERVER/hive_server_hive" } ], "name" : "HIVE_METASTORE" }, { "identities" : [ { "keytab" : { "configuration" : "hive-atlas-application.properties/atlas.jaas.KafkaClient.option.keyTab", "file" : null }, "name" : "atlas_kafka", "principal" : { "configuration" : "hive-atlas-application.properties/atlas.jaas.KafkaClient.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HIVE/HIVE_SERVER/hive_server_hive" }, { "name" : "hive_hive_server_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "hive-site/hive.server2.authentication.spnego.keytab", "file" : null }, "name" : "hive_hive_server_spnego", "principal" : { "configuration" : "hive-site/hive.server2.authentication.spnego.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "hive-site/hive.server2.authentication.kerberos.keytab", "file" : "${keytab_dir}/hive.service.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${hive-env/hive_user}" } }, "name" : "hive_server_hive", "principal" : { "configuration" : "hive-site/hive.server2.authentication.kerberos.principal", "local_username" : "${hive-env/hive_user}", "type" : "service", "value" : "hive/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ranger-hive-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "ranger_audit", "principal" : { "configuration" : "ranger-hive-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HIVE/HIVE_SERVER/hive_server_hive" } ], "name" : "HIVE_SERVER" }, { "identities" : [ { "name" : "hive_hive_server_interactive_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "name" : "hive_hive_server_interactive_hive_server_hive", "reference" : "/HIVE/HIVE_SERVER/hive_server_hive" }, { "name" : "hive_hive_server_interactive_llap_zk_hive", "reference" : "/YARN/NODEMANAGER/llap_zk_hive" }, { "name" : "hive_hive_server_interactive_spnego", "reference" : "/HIVE/HIVE_SERVER/spnego" }, { "keytab" : { "configuration" : "hive-interactive-site/hive.llap.task.scheduler.am.registry.keytab.file", "file" : null }, "name" : "hive_hive_server_interactive_task_scheduler_am_registry", "principal" : { "configuration" : "hive-interactive-site/hive.llap.task.scheduler.am.registry.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HIVE/HIVE_SERVER/hive_server_hive" } ], "name" : "HIVE_SERVER_INTERACTIVE" } ], "configurations" : [ { "hive-site" : { "hive.metastore.sasl.enabled" : "true", "hive.server2.authentication" : "KERBEROS" } }, { "ranger-hive-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "name" : "hive_smokeuser", "reference" : "/smokeuser" }, { "name" : "hive_spnego", "reference" : "/spnego" } ], "name" : "HIVE" }, { "auth_to_local_properties" : [ "kafka-broker/sasl.kerberos.principal.to.local.rules|comma" ], "components" : [ { "identities" : [ { "keytab" : { "configuration" : "kafka-env/kafka_keytab", "file" : "${keytab_dir}/kafka.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${kafka-env/kafka_user}" } }, "name" : "kafka_broker", "principal" : { "configuration" : "kafka-env/kafka_principal_name", "local_username" : null, "type" : "service", "value" : "${kafka-env/kafka_user}/_HOST@${realm}" } }, { "name" : "kafka_kafka_broker_hdfs", "reference" : "/HDFS/NAMENODE/hdfs", "when" : { "contains" : [ "services", "HDFS" ] } }, { "keytab" : { "configuration" : "ranger-kafka-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "kafka_kafka_broker_kafka_broker", "principal" : { "configuration" : "ranger-kafka-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/KAFKA/KAFKA_BROKER/kafka_broker" } ], "name" : "KAFKA_BROKER" } ], "configurations" : [ { "kafka-broker" : { "authorizer.class.name" : "kafka.security.auth.SimpleAclAuthorizer", "principal.to.local.class" : "kafka.security.auth.KerberosPrincipalToLocal", "security.inter.broker.protocol" : "PLAINTEXTSASL", "super.users" : "user:${kafka-env/kafka_user}", "zookeeper.set.acl" : "true" } }, { "ranger-kafka-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "name" : "kafka_smokeuser", "reference" : "/smokeuser" } ], "name" : "KAFKA" }, { "components" : [ { "name" : "KERBEROS_CLIENT" } ], "identities" : [ { "name" : "kerberos_smokeuser", "reference" : "/smokeuser" } ], "name" : "KERBEROS" }, { "components" : [ { "configurations" : [ { "core-site" : { "hadoop.proxyuser.${knox-env/knox_user}.groups" : "${hadoop-env/proxyuser_group}", "hadoop.proxyuser.${knox-env/knox_user}.hosts" : "${clusterHostInfo/knox_gateway_hosts}" } }, { "gateway-site" : { "gateway.hadoop.kerberos.secured" : "true", "java.security.krb5.conf" : "/etc/krb5.conf" } }, { "ranger-knox-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "keytab" : { "configuration" : "ranger-knox-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "knox_knox_gateway_knox_principal", "principal" : { "configuration" : "ranger-knox-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/KNOX/KNOX_GATEWAY/knox_principal" }, { "keytab" : { "configuration" : "knox-env/knox_keytab_path", "file" : "${keytab_dir}/knox.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${knox-env/knox_user}" } }, "name" : "knox_principal", "principal" : { "configuration" : "knox-env/knox_principal_name", "local_username" : "${knox-env/knox_user}", "type" : "service", "value" : "${knox-env/knox_user}/_HOST@${realm}" } } ], "name" : "KNOX_GATEWAY" } ], "name" : "KNOX" }, { "components" : [ { "identities" : [ { "keytab" : { "configuration" : "logfeeder-env/logfeeder_kerberos_keytab", "file" : "${keytab_dir}/logfeeder.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "root" } }, "name" : "logfeeder", "principal" : { "configuration" : "logfeeder-env/logfeeder_kerberos_principal", "local_username" : null, "type" : "service", "value" : "logfeeder/_HOST@${realm}" } } ], "name" : "LOGSEARCH_LOGFEEDER" }, { "identities" : [ { "keytab" : { "configuration" : "logsearch-env/logsearch_kerberos_keytab", "file" : "${keytab_dir}/logsearch.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${logsearch-env/logsearch_user}" } }, "name" : "logsearch", "principal" : { "configuration" : "logsearch-env/logsearch_kerberos_principal", "local_username" : null, "type" : "service", "value" : "logsearch/_HOST@${realm}" } }, { "name" : "logsearch_logsearch_server_infra-solr", "reference" : "/AMBARI_INFRA_SOLR/INFRA_SOLR/infra-solr", "when" : { "contains" : [ "services", "AMBARI_INFRA_SOLR" ] } } ], "name" : "LOGSEARCH_SERVER" } ], "identities" : [ { "name" : "logsearch_smokeuser", "reference" : "/smokeuser" } ], "name" : "LOGSEARCH" }, { "components" : [ { "identities" : [ { "keytab" : { "configuration" : "mapred-site/mapreduce.jobhistory.keytab", "file" : "${keytab_dir}/jhs.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${mapred-env/mapred_user}" } }, "name" : "history_server_jhs", "principal" : { "configuration" : "mapred-site/mapreduce.jobhistory.principal", "local_username" : "${mapred-env/mapred_user}", "type" : "service", "value" : "jhs/_HOST@${realm}" } }, { "name" : "mapreduce2_historyserver_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "mapred-site/mapreduce.jobhistory.webapp.spnego-keytab-file", "file" : null }, "name" : "mapreduce2_historyserver_spnego", "principal" : { "configuration" : "mapred-site/mapreduce.jobhistory.webapp.spnego-principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "HISTORYSERVER" } ], "configurations" : [ { "mapred-site" : { "mapreduce.cluster.acls.enabled" : "true", "mapreduce.jobhistory.admin.acl" : "${mapred-env/mapred_user}" } } ], "identities" : [ { "name" : "mapreduce2_smokeuser", "reference" : "/smokeuser" }, { "name" : "mapreduce2_spnego", "reference" : "/spnego" } ], "name" : "MAPREDUCE2" }, { "auth_to_local_properties" : [ "oozie-site/oozie.authentication.kerberos.name.rules" ], "components" : [ { "identities" : [ { "name" : "oozie_oozie_server_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "oozie-site/oozie.authentication.kerberos.keytab", "file" : null }, "name" : "oozie_oozie_server_spnego", "principal" : { "configuration" : "oozie-site/oozie.authentication.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "oozie-site/oozie.service.HadoopAccessorService.keytab.file", "file" : "${keytab_dir}/oozie.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${oozie-env/oozie_user}" } }, "name" : "oozie_server", "principal" : { "configuration" : "oozie-site/oozie.service.HadoopAccessorService.kerberos.principal", "local_username" : "${oozie-env/oozie_user}", "type" : "service", "value" : "oozie/_HOST@${realm}" } } ], "name" : "OOZIE_SERVER" } ], "configurations" : [ { "oozie-site" : { "local.realm" : "${realm}", "oozie.authentication.type" : "kerberos", "oozie.credentials.credentialclasses" : "hcat=org.apache.oozie.action.hadoop.HCatCredentials,hive2=org.apache.oozie.action.hadoop.Hive2Credentials", "oozie.service.AuthorizationService.authorization.enabled" : "true", "oozie.service.HadoopAccessorService.kerberos.enabled" : "true", "oozie.zookeeper.secure" : "true" } } ], "identities" : [ { "name" : "oozie_smokeuser", "reference" : "/smokeuser" }, { "name" : "oozie_spnego", "reference" : "/spnego" } ], "name" : "OOZIE" }, { "components" : [ { "identities" : [ { "name" : "pig_pig_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" } ], "name" : "PIG" } ], "name" : "PIG" }, { "components" : [ { "identities" : [ { "name" : "ranger_ranger_admin_infra-solr", "reference" : "/AMBARI_INFRA_SOLR/INFRA_SOLR/infra-solr", "when" : { "contains" : [ "services", "AMBARI_INFRA_SOLR" ] } }, { "keytab" : { "configuration" : "ranger-admin-site/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "ranger_ranger_admin_rangeradmin", "principal" : { "configuration" : "ranger-admin-site/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/RANGER/RANGER_ADMIN/rangeradmin" }, { "keytab" : { "configuration" : "ranger-admin-site/ranger.spnego.kerberos.keytab", "file" : null }, "name" : "ranger_ranger_admin_spnego", "reference" : "/spnego" }, { "keytab" : { "configuration" : "ranger-admin-site/ranger.admin.kerberos.keytab", "file" : "${keytab_dir}/rangeradmin.service.keytab", "owner" : { "access" : "r", "name" : "${ranger-env/ranger_user}" } }, "name" : "rangeradmin", "principal" : { "configuration" : "ranger-admin-site/ranger.admin.kerberos.principal", "local_username" : "${ranger-env/ranger_user}", "type" : "service", "value" : "rangeradmin/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ranger-admin-site/ranger.lookup.kerberos.keytab", "file" : "${keytab_dir}/rangerlookup.service.keytab", "owner" : { "access" : "r", "name" : "${ranger-env/ranger_user}" } }, "name" : "rangerlookup", "principal" : { "configuration" : "ranger-admin-site/ranger.lookup.kerberos.principal", "local_username" : null, "type" : "service", "value" : "rangerlookup/_HOST@${realm}" } } ], "name" : "RANGER_ADMIN" }, { "configurations" : [ { "tagsync-application-properties" : { "atlas.jaas.KafkaClient.loginModuleControlFlag" : "required", "atlas.jaas.KafkaClient.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "atlas.jaas.KafkaClient.option.serviceName" : "kafka", "atlas.jaas.KafkaClient.option.storeKey" : "true", "atlas.jaas.KafkaClient.option.useKeyTab" : "true", "atlas.kafka.sasl.kerberos.service.name" : "kafka", "atlas.kafka.security.protocol" : "PLAINTEXTSASL" } } ], "identities" : [ { "keytab" : { "configuration" : "tagsync-application-properties/atlas.jaas.KafkaClient.option.keyTab", "file" : null }, "name" : "ranger_ranger_tagsync_rangertagsync", "principal" : { "configuration" : "tagsync-application-properties/atlas.jaas.KafkaClient.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/RANGER/RANGER_TAGSYNC/rangertagsync" }, { "keytab" : { "configuration" : "ranger-tagsync-site/ranger.tagsync.kerberos.keytab", "file" : "${keytab_dir}/rangertagsync.service.keytab", "owner" : { "access" : "r", "name" : "${ranger-env/ranger_user}" } }, "name" : "rangertagsync", "principal" : { "configuration" : "ranger-tagsync-site/ranger.tagsync.kerberos.principal", "local_username" : "rangertagsync", "type" : "service", "value" : "rangertagsync/_HOST@${realm}" } } ], "name" : "RANGER_TAGSYNC" }, { "identities" : [ { "keytab" : { "configuration" : "ranger-ugsync-site/ranger.usersync.kerberos.keytab", "file" : "${keytab_dir}/rangerusersync.service.keytab", "owner" : { "access" : "r", "name" : "${ranger-env/ranger_user}" } }, "name" : "rangerusersync", "principal" : { "configuration" : "ranger-ugsync-site/ranger.usersync.kerberos.principal", "local_username" : "rangerusersync", "type" : "service", "value" : "rangerusersync/_HOST@${realm}" } } ], "name" : "RANGER_USERSYNC" } ], "configurations" : [ { "ranger-admin-site" : { "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "name" : "ranger_smokeuser", "reference" : "/smokeuser" }, { "name" : "ranger_spnego", "reference" : "/spnego" } ], "name" : "RANGER" }, { "auth_to_local_properties" : [ "kms-site/hadoop.kms.authentication.kerberos.name.rules" ], "components" : [ { "identities" : [ { "keytab" : { "configuration" : "ranger-kms-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "ranger_kms_ranger_kms_server_rangerkms", "principal" : { "configuration" : "ranger-kms-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/RANGER_KMS/RANGER_KMS_SERVER/rangerkms" }, { "keytab" : { "configuration" : "kms-site/hadoop.kms.authentication.signer.secret.provider.zookeeper.kerberos.keytab", "file" : null }, "name" : "ranger_kms_ranger_kms_server_spnego", "principal" : { "configuration" : "kms-site/hadoop.kms.authentication.signer.secret.provider.zookeeper.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "dbks-site/ranger.ks.kerberos.keytab", "file" : "${keytab_dir}/rangerkms.service.keytab", "owner" : { "access" : "r", "name" : "${kms-env/kms_user}" } }, "name" : "rangerkms", "principal" : { "configuration" : "dbks-site/ranger.ks.kerberos.principal", "local_username" : "keyadmin", "type" : "service", "value" : "rangerkms/_HOST@${realm}" } } ], "name" : "RANGER_KMS_SERVER" } ], "configurations" : [ { "kms-site" : { "hadoop.kms.authentication.kerberos.principal" : "*", "hadoop.kms.authentication.type" : "kerberos" } }, { "ranger-kms-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } } ], "identities" : [ { "keytab" : { "configuration" : "kms-site/hadoop.kms.authentication.kerberos.keytab", "file" : null }, "name" : "ranger_kms_spnego", "reference" : "/spnego" } ], "name" : "RANGER_KMS" }, { "components" : [ { "configurations" : [ { "ams-hbase-site" : { "hbase.superuser" : "${activity-conf/global.activity.analyzer.user},${activity-conf/activity.explorer.user},${ams-env/ambari_metrics_user}" } }, { "yarn-site" : { "yarn.admin.acl" : "${activity-conf/global.activity.analyzer.user},dr.who,${yarn-env/yarn_user}" } } ], "identities" : [ { "keytab" : { "configuration" : "activity-conf/global.activity.analyzer.user.keytab", "file" : "${keytab_dir}/activity-analyzer.headless.keytab", "owner" : { "access" : "r" } }, "name" : "activity_analyzer", "principal" : { "configuration" : "activity-conf/global.activity.analyzer.user.principal", "local_username" : "${activity-conf/global.activity.analyzer.user}", "type" : "service", "value" : "${activity-conf/global.activity.analyzer.user}/_HOST@${realm}" } } ], "name" : "ACTIVITY_ANALYZER" }, { "configurations" : [ { "activity-zeppelin-site" : { "zeppelin.server.kerberos.keytab" : "${keytab_dir}/activity-explorer.headless.keytab", "zeppelin.server.kerberos.principal" : "${activity-conf/activity.explorer.user}/_HOST@${realm}" } }, { "ams-hbase-site" : { "hbase.superuser" : "${activity-conf/global.activity.analyzer.user},${activity-conf/activity.explorer.user},${ams-env/ambari_metrics_user}" } }, { "yarn-site" : { "yarn.admin.acl" : "${activity-conf/global.activity.analyzer.user},dr.who,${yarn-env/yarn_user}" } } ], "identities" : [ { "keytab" : { "configuration" : "activity-conf/activity.explorer.user.keytab", "file" : "${keytab_dir}/activity-explorer.headless.keytab", "owner" : { "access" : "r" } }, "name" : "activity_explorer", "principal" : { "configuration" : "activity-conf/activity.explorer.user.principal", "local_username" : "${activity-conf/activity.explorer.user}", "type" : "service", "value" : "${activity-conf/activity.explorer.user}/_HOST@${realm}" } } ], "name" : "ACTIVITY_EXPLORER" } ], "name" : "SMARTSENSE" }, { "components" : [ { "identities" : [ { "name" : "hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "livy2-conf/livy.server.auth.kerberos.keytab", "file" : null }, "name" : "livy_spnego", "principal" : { "configuration" : "livy2-conf/livy.server.auth.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "livy2-conf/livy.server.launch.kerberos.keytab", "file" : "${keytab_dir}/livy.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${livy2-env/livy2_user}" } }, "name" : "livyuser", "principal" : { "configuration" : "livy2-conf/livy.server.launch.kerberos.principal", "local_username" : "${livy2-env/livy2_user}", "type" : "service", "value" : "${livy2-env/livy2_user}/_HOST@${realm}" } } ], "name" : "LIVY2_SERVER" }, { "name" : "SPARK2_CLIENT" }, { "identities" : [ { "name" : "hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "spark2-defaults/history.server.spnego.keytab.file", "file" : null }, "name" : "history_server_spnego", "principal" : { "configuration" : "spark2-defaults/history.server.spnego.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" }, { "keytab" : { "configuration" : "spark2-defaults/spark.history.kerberos.keytab", "file" : null }, "name" : "shs_spark_service_identity", "principal" : { "configuration" : "spark2-defaults/spark.history.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/SPARK2/spark_service_keytab" } ], "name" : "SPARK2_JOBHISTORYSERVER" }, { "identities" : [ { "name" : "hdfs", "reference" : "/HDFS/NAMENODE/hdfs" } ], "name" : "SPARK2_THRIFTSERVER" } ], "configurations" : [ { "livy2-conf" : { "livy.impersonation.enabled" : "true", "livy.server.auth.type" : "kerberos" } }, { "spark2-defaults" : { "spark.history.kerberos.enabled" : "true" } } ], "identities" : [ { "name" : "spark2_smokeuser", "reference" : "/smokeuser" }, { "keytab" : { "file" : "${keytab_dir}/spark.headless.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${spark2-env/spark_user}" } }, "name" : "spark2user", "principal" : { "configuration" : null, "local_username" : "${spark2-env/spark_user}", "type" : "user", "value" : "${spark2-env/spark_user}${principal_suffix}@${realm}" } }, { "keytab" : { "configuration" : "spark2-hive-site-override/hive.server2.authentication.kerberos.keytab", "file" : "${keytab_dir}/spark.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${spark2-env/spark_user}" } }, "name" : "spark_service_keytab", "principal" : { "configuration" : "spark2-hive-site-override/hive.server2.authentication.kerberos.principal", "local_username" : "${spark2-env/spark_user}", "type" : "service", "value" : "spark/_HOST@${realm}" } } ], "name" : "SPARK2" }, { "components" : [ { "name" : "SQOOP" } ], "configurations" : [ { "sqoop-atlas-application.properties" : { "atlas.jaas.KafkaClient.option.renewTicket" : "true", "atlas.jaas.KafkaClient.option.useTicketCache" : "true" } } ], "name" : "SQOOP" }, { "components" : [ { "identities" : [ { "name" : "drpc_server", "reference" : "/STORM/NIMBUS/nimbus_server" } ], "name" : "DRPC_SERVER" }, { "identities" : [ { "keytab" : { "configuration" : "storm-env/nimbus_keytab", "file" : "${keytab_dir}/nimbus.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${storm-env/storm_user}" } }, "name" : "nimbus_server", "principal" : { "configuration" : "storm-env/nimbus_principal_name", "local_username" : null, "type" : "service", "value" : "nimbus/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ranger-storm-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "storm_numbus_storm_components", "principal" : { "configuration" : "ranger-storm-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/STORM/storm_components" } ], "name" : "NIMBUS" }, { "identities" : [ { "keytab" : { "configuration" : "storm-env/storm_ui_keytab", "file" : null }, "name" : "storm_storm_ui_server_spnego", "principal" : { "configuration" : "storm-env/storm_ui_principal_name", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "STORM_UI_SERVER" }, { "name" : "SUPERVISOR" } ], "configurations" : [ { "ranger-storm-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } }, { "storm-site" : { "drpc.authorizer" : "org.apache.storm.security.auth.authorizer.DRPCSimpleACLAuthorizer", "java.security.auth.login.config" : "{{conf_dir}}/storm_jaas.conf", "nimbus.admins" : "['{{storm_bare_jaas_principal}}', '{{ambari_bare_jaas_principal}}']", "nimbus.authorizer" : "org.apache.storm.security.auth.authorizer.SimpleACLAuthorizer", "nimbus.impersonation.acl" : "{ {{storm_bare_jaas_principal}} : {hosts: ['*'], groups: ['*']}}", "nimbus.impersonation.authorizer" : "org.apache.storm.security.auth.authorizer.ImpersonationAuthorizer", "nimbus.supervisor.users" : "['{{storm_bare_jaas_principal}}']", "storm.principal.tolocal" : "org.apache.storm.security.auth.KerberosPrincipalToLocal", "storm.thrift.transport" : "org.apache.storm.security.auth.kerberos.KerberosSaslTransportPlugin", "storm.zookeeper.superACL" : "sasl:{{storm_bare_jaas_principal}}", "supervisor.enable" : "true", "ui.filter" : "org.apache.storm.org.apache.hadoop.security.authentication.server.AuthenticationFilter", "ui.filter.params" : "{'type': 'kerberos', 'kerberos.principal': '{{storm_ui_jaas_principal}}', 'kerberos.keytab': '{{storm_ui_keytab_path}}', 'kerberos.name.rules': 'DEFAULT'}" } } ], "identities" : [ { "keytab" : { "configuration" : "storm-env/storm_keytab", "file" : "${keytab_dir}/storm.headless.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${storm-env/storm_user}" } }, "name" : "storm_components", "principal" : { "configuration" : "storm-env/storm_principal_name", "local_username" : null, "type" : "user", "value" : "${storm-env/storm_user}${principal_suffix}@${realm}" } }, { "name" : "storm_smokeuser", "reference" : "/smokeuser" }, { "name" : "storm_spnego", "reference" : "/spnego" }, { "keytab" : { "configuration" : "storm-atlas-application.properties/atlas.jaas.KafkaClient.option.keyTab", "file" : null }, "name" : "storm_storm_components", "principal" : { "configuration" : "storm-atlas-application.properties/atlas.jaas.KafkaClient.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/STORM/storm_components" } ], "name" : "STORM" }, { "components" : [ { "name" : "SUPERSET" } ], "configurations" : [ { "superset" : { "ENABLE_KERBEROS_AUTHENTICATION" : "True", "KERBEROS_REINIT_TIME_SEC" : "3600" } } ], "identities" : [ { "keytab" : { "configuration" : "superset/KERBEROS_KEYTAB", "file" : "${keytab_dir}/superset.headless.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${superset-env/superset_user}" } }, "name" : "superset", "principal" : { "configuration" : "superset/KERBEROS_PRINCIPAL", "local_username" : "${superset-env/superset_user}", "type" : "user", "value" : "${superset-env/superset_user}${principal_suffix}@${realm}" } }, { "name" : "superset_smokeuser", "reference" : "/smokeuser" } ], "name" : "SUPERSET" }, { "components" : [ { "configurations" : [ { "tez-site" : { "tez.am.view-acls" : "" } } ], "identities" : [ { "name" : "tez_tez_client_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" } ], "name" : "TEZ_CLIENT" } ], "name" : "TEZ" }, { "components" : [ { "identities" : [ { "keytab" : { "configuration" : "yarn-site/yarn.timeline-service.keytab", "file" : "${keytab_dir}/yarn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_user}" } }, "name" : "app_timeline_server_yarn", "principal" : { "configuration" : "yarn-site/yarn.timeline-service.principal", "local_username" : "${yarn-env/yarn_user}", "type" : "service", "value" : "yarn/_HOST@${realm}" } }, { "name" : "yarn_app_timeline_server_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "yarn-site/yarn.timeline-service.http-authentication.kerberos.keytab", "file" : null }, "name" : "yarn_app_timeline_server_spnego", "principal" : { "configuration" : "yarn-site/yarn.timeline-service.http-authentication.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "APP_TIMELINE_SERVER" }, { "configurations" : [ { "yarn-site" : { "yarn.nodemanager.container-executor.class" : "org.apache.hadoop.yarn.server.nodemanager.LinuxContainerExecutor" } } ], "identities" : [ { "keytab" : { "configuration" : "hive-interactive-site/hive.llap.task.keytab.file", "file" : "${keytab_dir}/hive.llap.task.keytab", "group" : { "access" : "r", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_user}" } }, "name" : "llap_task_hive", "principal" : { "configuration" : "hive-interactive-site/hive.llap.task.principal", "local_username" : null, "type" : "service", "value" : "hive/_HOST@${realm}" }, "when" : { "contains" : [ "services", "HIVE" ] } }, { "keytab" : { "configuration" : "yarn-site/yarn.nodemanager.keytab", "file" : "${keytab_dir}/nm.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_user}" } }, "name" : "nodemanager_nm", "principal" : { "configuration" : "yarn-site/yarn.nodemanager.principal", "local_username" : "${yarn-env/yarn_user}", "type" : "service", "value" : "nm/_HOST@${realm}" } }, { "keytab" : { "configuration" : "hive-interactive-site/hive.llap.daemon.keytab.file", "file" : null }, "name" : "yarn_nodemanager_hive_server_hive", "principal" : { "configuration" : "hive-interactive-site/hive.llap.daemon.service.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/HIVE/HIVE_SERVER/hive_server_hive", "when" : { "contains" : [ "services", "HIVE" ] } }, { "keytab" : { "configuration" : "yarn-site/yarn.nodemanager.webapp.spnego-keytab-file", "file" : null }, "name" : "yarn_nodemanager_spnego", "principal" : { "configuration" : "yarn-site/yarn.nodemanager.webapp.spnego-principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "NODEMANAGER" }, { "identities" : [ { "keytab" : { "configuration" : "yarn-site/yarn.resourcemanager.keytab", "file" : "${keytab_dir}/rm.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_user}" } }, "name" : "resource_manager_rm", "principal" : { "configuration" : "yarn-site/yarn.resourcemanager.principal", "local_username" : "${yarn-env/yarn_user}", "type" : "service", "value" : "rm/_HOST@${realm}" } }, { "keytab" : { "configuration" : "ranger-yarn-audit/xasecure.audit.jaas.Client.option.keyTab", "file" : null }, "name" : "yarn_resourcemanager_resource_manager_rm", "principal" : { "configuration" : "ranger-yarn-audit/xasecure.audit.jaas.Client.option.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/YARN/RESOURCEMANAGER/resource_manager_rm" }, { "keytab" : { "configuration" : "yarn-site/yarn.resourcemanager.webapp.spnego-keytab-file", "file" : null }, "name" : "yarn_resourcemanager_spnego", "principal" : { "configuration" : "yarn-site/yarn.resourcemanager.webapp.spnego-principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "RESOURCEMANAGER" }, { "identities" : [ { "keytab" : { "configuration" : "yarn-site/yarn.timeline-service.keytab", "file" : "${keytab_dir}/yarn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_user}" } }, "name" : "yarn_timeline_reader", "principal" : { "configuration" : "yarn-site/yarn.timeline-service.principal", "local_username" : "${yarn-env/yarn_user}", "type" : "service", "value" : "yarn/_HOST@${realm}" } }, { "name" : "yarn_timeline_reader_hdfs", "reference" : "/HDFS/NAMENODE/hdfs" }, { "keytab" : { "configuration" : "yarn-site/yarn.timeline-service.http-authentication.kerberos.keytab", "file" : null }, "name" : "yarn_timeline_reader_spnego", "principal" : { "configuration" : "yarn-site/yarn.timeline-service.http-authentication.kerberos.principal", "local_username" : null, "type" : null, "value" : null }, "reference" : "/spnego" } ], "name" : "TIMELINE_READER" }, { "identities" : [ { "keytab" : { "configuration" : "yarn-env/yarn.registry-dns.keytab", "file" : "${keytab_dir}/yarn.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_user}" } }, "name" : "registry_dns_yarn", "principal" : { "configuration" : "yarn-env/yarn.registry-dns.principal", "local_username" : "${yarn-env/yarn_user}", "type" : "service", "value" : "yarn/_HOST@${realm}" } } ], "name" : "YARN_REGISTRY_DNS" } ], "configurations" : [ { "capacity-scheduler" : { "yarn.scheduler.capacity.root.acl_administer_queue" : "${yarn-env/yarn_user}", "yarn.scheduler.capacity.root.acl_submit_applications" : "${yarn-env/yarn_user},${cluster-env/smokeuser}", "yarn.scheduler.capacity.root.default.acl_administer_jobs" : "${yarn-env/yarn_user}", "yarn.scheduler.capacity.root.default.acl_administer_queue" : "${yarn-env/yarn_user}", "yarn.scheduler.capacity.root.default.acl_submit_applications" : "${yarn-env/yarn_user},${yarn-env/yarn_ats_user}" } }, { "core-site" : { "hadoop.proxyuser.${yarn-env/yarn_user}.groups" : "*", "hadoop.proxyuser.${yarn-env/yarn_user}.hosts" : "${clusterHostInfo/resourcemanager_hosts}" } }, { "ranger-yarn-audit" : { "xasecure.audit.destination.solr.force.use.inmemory.jaas.config" : "true", "xasecure.audit.jaas.Client.loginModuleControlFlag" : "required", "xasecure.audit.jaas.Client.loginModuleName" : "com.sun.security.auth.module.Krb5LoginModule", "xasecure.audit.jaas.Client.option.serviceName" : "solr", "xasecure.audit.jaas.Client.option.storeKey" : "false", "xasecure.audit.jaas.Client.option.useKeyTab" : "true" } }, { "yarn-hbase-site" : { "hbase.coprocessor.master.classes" : "org.apache.hadoop.hbase.security.access.AccessController", "hbase.coprocessor.region.classes" : "org.apache.hadoop.hbase.security.token.TokenProvider,org.apache.hadoop.hbase.security.access.AccessController", "hbase.security.authentication" : "kerberos", "hbase.security.authorization" : "true", "zookeeper.znode.parent" : "/atsv2-hbase-secure" } }, { "yarn-site" : { "hadoop.registry.client.auth" : "kerberos", "hadoop.registry.jaas.context" : "Client", "hadoop.registry.secure" : "true", "hadoop.registry.system.accounts" : "sasl:${principals/YARN/APP_TIMELINE_SERVER/app_timeline_server_yarn|principalPrimary()},sasl:${principals/MAPREDUCE2/HISTORYSERVER/history_server_jhs|principalPrimary()},sasl:${principals/HDFS/NAMENODE/hdfs|principalPrimary()},sasl:${principals/YARN/RESOURCEMANAGER/resource_manager_rm|principalPrimary()},sasl:${principals/HIVE/HIVE_SERVER/hive_server_hive|principalPrimary()},sasl:${principals/SPARK2/spark_service_keytab|principalPrimary()}", "yarn.acl.enable" : "true", "yarn.admin.acl" : "${yarn-env/yarn_user}", "yarn.resourcemanager.proxy-user-privileges.enabled" : "true", "yarn.resourcemanager.proxyuser.*.groups" : "", "yarn.resourcemanager.proxyuser.*.hosts" : "", "yarn.resourcemanager.proxyuser.*.users" : "", "yarn.resourcemanager.zk-acl" : "sasl:${principals/YARN/RESOURCEMANAGER/resource_manager_rm|principalPrimary()}:rwcda", "yarn.timeline-service.enabled" : "true", "yarn.timeline-service.http-authentication.cookie.domain" : "", "yarn.timeline-service.http-authentication.cookie.path" : "", "yarn.timeline-service.http-authentication.kerberos.name.rules" : "", "yarn.timeline-service.http-authentication.proxyuser.*.groups" : "", "yarn.timeline-service.http-authentication.proxyuser.*.hosts" : "", "yarn.timeline-service.http-authentication.proxyuser.*.users" : "", "yarn.timeline-service.http-authentication.signature.secret" : "", "yarn.timeline-service.http-authentication.signature.secret.file" : "", "yarn.timeline-service.http-authentication.signer.secret.provider" : "", "yarn.timeline-service.http-authentication.signer.secret.provider.object" : "", "yarn.timeline-service.http-authentication.token.validity" : "", "yarn.timeline-service.http-authentication.type" : "kerberos" } } ], "identities" : [ { "keytab" : { "configuration" : "yarn-env/yarn_ats_user_keytab", "file" : "${keytab_dir}/yarn-ats.hbase-client.headless.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_ats_user}" } }, "name" : "yarn_ats", "principal" : { "configuration" : "yarn-env/yarn_ats_principal_name", "local_username" : "${yarn-env/yarn_ats_user}", "type" : "user", "value" : "${yarn-env/yarn_ats_user}${principal_suffix}@${realm}" } }, { "keytab" : { "configuration" : "yarn-hbase-site/hbase.master.keytab.file", "file" : "${keytab_dir}/yarn-ats.hbase-master.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_ats_user}" } }, "name" : "yarn_ats_hbase_master", "principal" : { "configuration" : "yarn-hbase-site/hbase.master.kerberos.principal", "local_username" : "${yarn-env/yarn_ats_user}", "type" : "service", "value" : "yarn-ats-hbase/_HOST@${realm}" } }, { "keytab" : { "configuration" : "yarn-hbase-site/hbase.regionserver.keytab.file", "file" : "${keytab_dir}/yarn-ats.hbase-regionserver.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${yarn-env/yarn_ats_user}" } }, "name" : "yarn_ats_hbase_regionserver", "principal" : { "configuration" : "yarn-hbase-site/hbase.regionserver.kerberos.principal", "local_username" : "${yarn-env/yarn_ats_user}", "type" : "service", "value" : "yarn-ats-hbase/_HOST@${realm}" } }, { "name" : "yarn_smokeuser", "reference" : "/smokeuser" }, { "name" : "yarn_spnego", "reference" : "/spnego" } ], "name" : "YARN" }, { "components" : [ { "name" : "ZEPPELIN_MASTER" } ], "configurations" : [ { "core-site" : { "hadoop.proxyuser.${zeppelin-env/zeppelin_user}.groups" : "*", "hadoop.proxyuser.${zeppelin-env/zeppelin_user}.hosts" : "*" } }, { "zeppelin-env" : { "zeppelin.kerberos.enabled" : "true" } } ], "identities" : [ { "name" : "zeppelin_smokeuser", "reference" : "/smokeuser" }, { "keytab" : { "configuration" : "zeppelin-site/zeppelin.server.kerberos.keytab", "file" : "${keytab_dir}/zeppelin.server.kerberos.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${zeppelin-env/zeppelin_user}" } }, "name" : "zeppelin_user", "principal" : { "configuration" : "zeppelin-site/zeppelin.server.kerberos.principal", "local_username" : "${zeppelin-env/zeppelin_user}", "type" : "user", "value" : "${zeppelin-env/zeppelin_user}${principal_suffix}@${realm}" } } ], "name" : "ZEPPELIN" }, { "components" : [ { "identities" : [ { "keytab" : { "configuration" : "zookeeper-env/zookeeper_keytab_path", "file" : "${keytab_dir}/zk.service.keytab", "group" : { "access" : "", "name" : "${cluster-env/user_group}" }, "owner" : { "access" : "r", "name" : "${zookeeper-env/zk_user}" } }, "name" : "zookeeper_zk", "principal" : { "configuration" : "zookeeper-env/zookeeper_principal_name", "local_username" : null, "type" : "service", "value" : "zookeeper/_HOST@${realm}" } } ], "name" : "ZOOKEEPER_SERVER" } ], "identities" : [ { "name" : "zookeeper_smokeuser", "reference" : "/smokeuser" } ], "name" : "ZOOKEEPER" } ] } }
